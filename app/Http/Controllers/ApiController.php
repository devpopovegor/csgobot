<?php

namespace App\Http\Controllers;

use App\Item;
use App\Paintseed;
use App\Pattern;
use App\Task;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\DB;
use Illuminate\Support\Facades\Log;
use Telegram\Bot\Laravel\Facades\Telegram;

class ApiController extends Controller
{
    public function addItem()
    {
        $name = $_GET['name'];
        $phase = $_GET['phase'] ? $_GET['phase'] : '';
        $float = $_GET['float'];
        $pattern = $_GET['pattern'];
        $item = Item::where('name', '=', $name)->where('phase', '=', $phase)->first();
        if ($item){
            if (Task::where('item_id', '=', $item->id)->where('client','=','ska4an')
                ->where('site_id', '=', 7)->where('float', '=', $float)->where('pattern', '=', $pattern)->first()){
                return "Search already exists";
            }
        }
        else {
            return "Item not exists";
        }

        Task::create(['item_id' => $item->id, 'site_id' => 7, 'float' => $float, 'client' => 'ska4an', 'pattern' => $pattern, 'chat_id' => '']);
        return "OK";
    }

    public function getList()
    {
        $tasks = json_encode(Task::with('item')->where('site_id', '=', '7')
            ->where('client','=', 'ska4an')->get());

        return json_encode($tasks);
    }

    public function getPatterns()
    {
        return json_encode(Pattern::all());
    }

    public function send()
    {
    	$item = Item::find($_GET['item_id']);
	    Telegram::sendMessage([
		    'chat_id' => 222881167,
		    'text' => "Бот для cs.money отправил оффер на {$item->full_name}",
		    'parse_mode' => 'HTML'
	    ]);

	    return json_encode('ok');
    }

    public function setPatterns()
    {
        set_time_limit(0);
        $patterns = json_decode('[{"paintseed":"412","item":"9949959088"},{"paintseed":"412","item":"11990557381"},{"paintseed":"412","item":"4587503902"},{"paintseed":"412","item":"7816523221"},{"paintseed":"412","item":"2590242169"},{"paintseed":"393","item":"3531429254"},{"paintseed":"393","item":"11945532539"},{"paintseed":"393","item":"288976991"},{"paintseed":"393","item":"12447790094"},{"paintseed":"393","item":"1083593278"},{"paintseed":"393","item":"8316384525"},{"paintseed":"602","item":"12497135244"},{"paintseed":"602","item":"7100748996"},{"paintseed":"602","item":"8857269128"},{"paintseed":"602","item":"9186459906"},{"paintseed":"602","item":"5582815547"},{"paintseed":"602","item":"12050338352"},{"paintseed":"359","item":"12340586242"},{"paintseed":"359","item":"11489253667"},{"paintseed":"359","item":"11610557590"},{"paintseed":"359","item":"6347723261"},{"paintseed":"359","item":"11140871616"},{"paintseed":"359","item":"10936487111"},{"paintseed":"359","item":"8670729582"},{"paintseed":"701","item":"11906773039"},{"paintseed":"701","item":"12163086200"},{"paintseed":"701","item":"8086434333"},{"paintseed":"701","item":"11527940518"},{"paintseed":"701","item":"12769986585"},{"paintseed":"701","item":"2823064369"},{"paintseed":"701","item":"11068646852"},{"paintseed":"701","item":"5789541897"},{"paintseed":"701","item":"7157969560"},{"paintseed":"649","item":"12634467281"},{"paintseed":"649","item":"11499105380"},{"paintseed":"649","item":"6223180388"},{"paintseed":"649","item":"7447837278"},{"paintseed":"649","item":"12838595900"},{"paintseed":"16","item":"4868104727"},{"paintseed":"16","item":"11977124533"},{"paintseed":"16","item":"9195062208"},{"paintseed":"16","item":"8829202717"},{"paintseed":"16","item":"248297902"},{"paintseed":"16","item":"370753234"},{"paintseed":"146","item":"7560971276"},{"paintseed":"146","item":"11536300042"},{"paintseed":"146","item":"6082903518"},{"paintseed":"146","item":"7704747299"},{"paintseed":"146","item":"8240854791"},{"paintseed":"146","item":"4285325715"},{"paintseed":"241","item":"9394256240"},{"paintseed":"241","item":"6648426843"},{"paintseed":"241","item":"12294843095"},{"paintseed":"541","item":"12686586582"},{"paintseed":"541","item":"8583695141"},{"paintseed":"541","item":"9568229451"},{"paintseed":"688","item":"10206850224"},{"paintseed":"688","item":"4300078750"},{"paintseed":"688","item":"1667398301"},{"paintseed":"688","item":"12861357309"},{"paintseed":"688","item":"10390112795"},{"paintseed":"673","item":"1567049085"},{"paintseed":"673","item":"10781403253"},{"paintseed":"673","item":"6941773683"},{"paintseed":"281","item":"8438913566"},{"paintseed":"281","item":"7705815173"},{"paintseed":"281","item":"910153304"},{"paintseed":"281","item":"327192258"},{"paintseed":"281","item":"11040624642"},{"paintseed":"344","item":"12446775003"},{"paintseed":"344","item":"11906920569"},{"paintseed":"344","item":"12693298856"},{"paintseed":"743","item":"12301069656"},{"paintseed":"743","item":"12865143591"},{"paintseed":"743","item":"7953538873"},{"paintseed":"777","item":"12743614260"},{"paintseed":"777","item":"4341793794"},{"paintseed":"777","item":"7533696600"},{"paintseed":"777","item":"8960159510"},{"paintseed":"777","item":"3156897100"},{"paintseed":"777","item":"8718993079"},{"paintseed":"292","item":"2433394375"},{"paintseed":"292","item":"4857948851"},{"paintseed":"292","item":"12606079049"},{"paintseed":"292","item":"12368798236"},{"paintseed":"994","item":"12241647279"},{"paintseed":"994","item":"12033547304"},{"paintseed":"994","item":"11128702617"},{"paintseed":"152","item":"11120202807"},{"paintseed":"152","item":"7929783902"},{"paintseed":"152","item":"12902585615"},{"paintseed":"918","item":"5224794302"},{"paintseed":"918","item":"8654533581"},{"paintseed":"918","item":"12752000818"},{"paintseed":"918","item":"12884865080"},{"paintseed":"918","item":"152797840"},{"paintseed":"918","item":"11060737064"},{"paintseed":"792","item":"7239759584"},{"paintseed":"792","item":"12258741313"},{"paintseed":"792","item":"1712871154"},{"paintseed":"792","item":"8667507062"},{"paintseed":"792","item":"12815271569"},{"paintseed":"792","item":"10938998904"},{"paintseed":"792","item":"6140346386"},{"paintseed":"792","item":"8179465815"},{"paintseed":"792","item":"11344247994"},{"paintseed":"792","item":"12847323108"},{"paintseed":"628","item":"8894605567"},{"paintseed":"628","item":"5669063180"},{"paintseed":"628","item":"8166781467"},{"paintseed":"628","item":"5029120637"},{"paintseed":"628","item":"8499061134"},{"paintseed":"628","item":"11562026873"},{"paintseed":"628","item":"12663173702"},{"paintseed":"628","item":"11632993215"},{"paintseed":"628","item":"10164497188"},{"paintseed":"628","item":"11229440042"},{"paintseed":"628","item":"9109694391"},{"paintseed":"628","item":"7187680561"},{"paintseed":"332","item":"11173996967"},{"paintseed":"332","item":"5827510279"},{"paintseed":"332","item":"10042469873"},{"paintseed":"332","item":"11499987622"},{"paintseed":"332","item":"6721874878"},{"paintseed":"332","item":"10912134554"},{"paintseed":"332","item":"12880111544"},{"paintseed":"129","item":"8809292937"},{"paintseed":"129","item":"5179443959"},{"paintseed":"129","item":"12421448628"},{"paintseed":"129","item":"6131505545"},{"paintseed":"129","item":"4734046534"},{"paintseed":"129","item":"10313060398"},{"paintseed":"129","item":"12915668874"},{"paintseed":"129","item":"11110723314"},{"paintseed":"874","item":"12581290407"},{"paintseed":"874","item":"9503761712"},{"paintseed":"874","item":"10421203351"},{"paintseed":"874","item":"6612220213"},{"paintseed":"874","item":"11393932123"},{"paintseed":"874","item":"12359323540"},{"paintseed":"874","item":"12764132371"},{"paintseed":"787","item":"12877380537"},{"paintseed":"787","item":"12239030633"},{"paintseed":"787","item":"11863184971"},{"paintseed":"787","item":"10222095363"},{"paintseed":"787","item":"10973846370"},{"paintseed":"126","item":"9463784332"},{"paintseed":"126","item":"10309858753"},{"paintseed":"126","item":"12060570724"},{"paintseed":"126","item":"12910006920"},{"paintseed":"126","item":"1573166221"},{"paintseed":"126","item":"8337723575"},{"paintseed":"923","item":"12722918605"},{"paintseed":"923","item":"12475107296"},{"paintseed":"923","item":"5642772299"},{"paintseed":"923","item":"2701477582"},{"paintseed":"923","item":"7766499790"},{"paintseed":"923","item":"12242416087"},{"paintseed":"923","item":"6495555910"},{"paintseed":"923","item":"93329001"},{"paintseed":"923","item":"11051954628"},{"paintseed":"923","item":"9320000118"},{"paintseed":"908","item":"8619010465"},{"paintseed":"908","item":"7982346986"},{"paintseed":"780","item":"11190197299"},{"paintseed":"780","item":"6707118306"},{"paintseed":"780","item":"12895004992"},{"paintseed":"780","item":"12751489852"},{"paintseed":"832","item":"10687732677"},{"paintseed":"832","item":"11915617612"},{"paintseed":"832","item":"12828414807"},{"paintseed":"832","item":"11623933460"},{"paintseed":"832","item":"11385539723"},{"paintseed":"832","item":"4208809531"},{"paintseed":"832","item":"10912134405"},{"paintseed":"736","item":"11910796387"},{"paintseed":"736","item":"6016412819"},{"paintseed":"252","item":"6818353328"},{"paintseed":"252","item":"6027273585"},{"paintseed":"252","item":"11493142766"},{"paintseed":"252","item":"8508372259"},{"paintseed":"252","item":"12603247617"},{"paintseed":"252","item":"12440459971"},{"paintseed":"252","item":"9692433525"},{"paintseed":"204","item":"6521086861"},{"paintseed":"204","item":"3792267078"},{"paintseed":"204","item":"9202379071"},{"paintseed":"182","item":"10165666815"},{"paintseed":"182","item":"779235664"},{"paintseed":"457","item":"811746038"},{"paintseed":"457","item":"11237758150"},{"paintseed":"457","item":"9021786861"},{"paintseed":"457","item":"12808451954"},{"paintseed":"457","item":"10916047598"},{"paintseed":"457","item":"12608688972"},{"paintseed":"457","item":"11786054439"},{"paintseed":"457","item":"12671102223"},{"paintseed":"457","item":"2963693244"},{"paintseed":"685","item":"11215607316"},{"paintseed":"685","item":"12421927736"},{"paintseed":"685","item":"7088505459"},{"paintseed":"660","item":"3379183783"},{"paintseed":"660","item":"10283368058"},{"paintseed":"660","item":"119470701"},{"paintseed":"660","item":"4932351425"},{"paintseed":"660","item":"12666155530"},{"paintseed":"660","item":"12707297551"},{"paintseed":"660","item":"12433285169"},{"paintseed":"652","item":"5969003285"},{"paintseed":"652","item":"387777382"},{"paintseed":"652","item":"11338880553"},{"paintseed":"652","item":"4565040568"},{"paintseed":"705","item":"6797196213"},{"paintseed":"705","item":"12483838507"},{"paintseed":"578","item":"10257509021"},{"paintseed":"578","item":"11139830648"},{"paintseed":"578","item":"9716642819"},{"paintseed":"522","item":"6191059418"},{"paintseed":"522","item":"5657265045"},{"paintseed":"522","item":"5002081677"},{"paintseed":"522","item":"7987818580"},{"paintseed":"522","item":"4260571022"},{"paintseed":"522","item":"9874705888"},{"paintseed":"522","item":"1003560011"},{"paintseed":"988","item":"11642545442"},{"paintseed":"988","item":"4797759461"},{"paintseed":"988","item":"6422473689"},{"paintseed":"607","item":"9927548443"},{"paintseed":"607","item":"9016142861"},{"paintseed":"230","item":"10169526494"},{"paintseed":"230","item":"5003898938"},{"paintseed":"230","item":"7253851178"},{"paintseed":"230","item":"12315115878"},{"paintseed":"230","item":"11527820354"},{"paintseed":"230","item":"11843203334"},{"paintseed":"230","item":"12316917241"},{"paintseed":"444","item":"12676524394"},{"paintseed":"444","item":"41056956"},{"paintseed":"444","item":"9007992104"},{"paintseed":"444","item":"8744192520"},{"paintseed":"471","item":"5958382387"},{"paintseed":"471","item":"11892390987"},{"paintseed":"471","item":"1415227700"},{"paintseed":"471","item":"10015290719"},{"paintseed":"471","item":"12643626300"},{"paintseed":"471","item":"12803436731"},{"paintseed":"773","item":"4888183993"},{"paintseed":"773","item":"12328900054"},{"paintseed":"773","item":"10863735427"},{"paintseed":"773","item":"12807870080"},{"paintseed":"773","item":"12413972919"},{"paintseed":"452","item":"12223711481"},{"paintseed":"452","item":"6334103185"},{"paintseed":"452","item":"11327802028"},{"paintseed":"452","item":"4348015301"},{"paintseed":"452","item":"12235233278"},{"paintseed":"452","item":"11586234599"},{"paintseed":"452","item":"6551517101"},{"paintseed":"452","item":"2063354877"},{"paintseed":"631","item":"6114034580"},{"paintseed":"631","item":"12258586360"},{"paintseed":"631","item":"4202266570"},{"paintseed":"631","item":"12213624838"},{"paintseed":"631","item":"9777027021"},{"paintseed":"631","item":"12420199674"},{"paintseed":"631","item":"11698663661"},{"paintseed":"982","item":"10528803396"},{"paintseed":"982","item":"11188733676"},{"paintseed":"982","item":"11997340529"},{"paintseed":"982","item":"11715583191"},{"paintseed":"356","item":"9381257088"},{"paintseed":"356","item":"4092653609"},{"paintseed":"356","item":"11948167483"},{"paintseed":"356","item":"6929661318"},{"paintseed":"340","item":"11926036104"},{"paintseed":"340","item":"11654701141"},{"paintseed":"340","item":"10096863131"},{"paintseed":"340","item":"11269725677"},{"paintseed":"340","item":"10262985660"},{"paintseed":"621","item":"12808270668"},{"paintseed":"621","item":"10044448869"},{"paintseed":"621","item":"12925944143"},{"paintseed":"621","item":"4740798382"},{"paintseed":"621","item":"10136191278"},{"paintseed":"112","item":"7981488253"},{"paintseed":"112","item":"12318101216"},{"paintseed":"112","item":"12306015844"},{"paintseed":"112","item":"4981815245"},{"paintseed":"112","item":"11884645503"},{"paintseed":"876","item":"11057200256"},{"paintseed":"876","item":"12687261824"},{"paintseed":"876","item":"12080649711"},{"paintseed":"876","item":"8775225951"},{"paintseed":"876","item":"12911681496"},{"paintseed":"876","item":"12115186427"},{"paintseed":"876","item":"12153771888"},{"paintseed":"761","item":"1803992494"},{"paintseed":"761","item":"9633046763"},{"paintseed":"761","item":"12855609610"},{"paintseed":"761","item":"11013841743"},{"paintseed":"761","item":"10020249814"},{"paintseed":"873","item":"9939397511"},{"paintseed":"873","item":"12782214621"},{"paintseed":"614","item":"12940465945"},{"paintseed":"614","item":"7279461052"},{"paintseed":"614","item":"11177256688"},{"paintseed":"614","item":"10389128822"},{"paintseed":"614","item":"12063228463"},{"paintseed":"14","item":"10381542880"},{"paintseed":"14","item":"6716706568"},{"paintseed":"14","item":"12274547361"},{"paintseed":"14","item":"12661374929"},{"paintseed":"274","item":"9762368597"},{"paintseed":"274","item":"8129502704"},{"paintseed":"274","item":"6933521010"},{"paintseed":"795","item":"6935157925"},{"paintseed":"795","item":"10571346330"},{"paintseed":"795","item":"443594533"},{"paintseed":"795","item":"8573501544"},{"paintseed":"795","item":"10954406728"},{"paintseed":"795","item":"10542222546"},{"paintseed":"795","item":"10995294945"},{"paintseed":"795","item":"12457830906"},{"paintseed":"795","item":"11918957032"},{"paintseed":"653","item":"12926147567"},{"paintseed":"653","item":"11247269023"},{"paintseed":"653","item":"12605973458"},{"paintseed":"653","item":"12701005797"},{"paintseed":"653","item":"6294502017"},{"paintseed":"653","item":"12086110804"},{"paintseed":"683","item":"6585474018"},{"paintseed":"683","item":"11174574404"},{"paintseed":"683","item":"6220046775"},{"paintseed":"683","item":"12024995205"},{"paintseed":"683","item":"7890242577"},{"paintseed":"683","item":"12218634768"},{"paintseed":"683","item":"5340970568"},{"paintseed":"826","item":"7802820131"},{"paintseed":"826","item":"12546631870"},{"paintseed":"826","item":"12690758517"},{"paintseed":"867","item":"8455305002"},{"paintseed":"867","item":"3287436064"},{"paintseed":"867","item":"12635264615"},{"paintseed":"867","item":"12419295192"},{"paintseed":"867","item":"10872026847"},{"paintseed":"867","item":"9602759678"},{"paintseed":"728","item":"4927057685"},{"paintseed":"728","item":"10321533684"},{"paintseed":"728","item":"12044660767"},{"paintseed":"728","item":"12586912550"},{"paintseed":"728","item":"4868377700"},{"paintseed":"728","item":"1081607631"},{"paintseed":"728","item":"12488048045"},{"paintseed":"405","item":"3397422753"},{"paintseed":"405","item":"12670257608"},{"paintseed":"405","item":"12004123092"},{"paintseed":"405","item":"11464865224"},{"paintseed":"405","item":"8228196266"},{"paintseed":"454","item":"7352978199"},{"paintseed":"454","item":"3130903297"},{"paintseed":"454","item":"12838595690"},{"paintseed":"108","item":"8629578066"},{"paintseed":"108","item":"8648371234"},{"paintseed":"108","item":"4840893300"},{"paintseed":"732","item":"10905772820"},{"paintseed":"732","item":"5104553331"},{"paintseed":"732","item":"12916354520"},{"paintseed":"732","item":"12085455080"},{"paintseed":"732","item":"12758289725"},{"paintseed":"732","item":"9751122626"},{"paintseed":"732","item":"12831633301"},{"paintseed":"732","item":"12013644500"},{"paintseed":"803","item":"5369556726"},{"paintseed":"803","item":"10467830233"},{"paintseed":"803","item":"2544609039"},{"paintseed":"803","item":"8040177938"},{"paintseed":"803","item":"286029648"},{"paintseed":"803","item":"10179573457"},{"paintseed":"233","item":"12902379940"},{"paintseed":"233","item":"7971239171"},{"paintseed":"233","item":"10603206826"},{"paintseed":"233","item":"6047990694"},{"paintseed":"233","item":"12586419649"},{"paintseed":"233","item":"10300569534"},{"paintseed":"770","item":"9029703730"},{"paintseed":"770","item":"10996120789"},{"paintseed":"770","item":"5179504825"},{"paintseed":"770","item":"12271694415"},{"paintseed":"32","item":"12788484057"},{"paintseed":"32","item":"11670813571"},{"paintseed":"32","item":"12180756095"},{"paintseed":"32","item":"11528438599"},{"paintseed":"32","item":"303716597"},{"paintseed":"32","item":"11725686100"},{"paintseed":"32","item":"9623768526"},{"paintseed":"32","item":"3828145521"},{"paintseed":"32","item":"7311817228"},{"paintseed":"32","item":"10769434950"},{"paintseed":"32","item":"8606202087"},{"paintseed":"32","item":"2375938930"},{"paintseed":"8","item":"12483838625"},{"paintseed":"8","item":"12520134410"},{"paintseed":"8","item":"12897239234"},{"paintseed":"58","item":"11067990136"},{"paintseed":"58","item":"10749715290"},{"paintseed":"58","item":"12645769520"},{"paintseed":"58","item":"108552271"},{"paintseed":"58","item":"12763275737"},{"paintseed":"58","item":"1844570269"},{"paintseed":"58","item":"5331469043"},{"paintseed":"58","item":"12614458578"},{"paintseed":"58","item":"5656569518"},{"paintseed":"58","item":"7745843698"},{"paintseed":"949","item":"12193630779"},{"paintseed":"949","item":"9565622955"},{"paintseed":"949","item":"9277857133"},{"paintseed":"949","item":"6560816104"},{"paintseed":"243","item":"11814125073"},{"paintseed":"243","item":"5753610904"},{"paintseed":"243","item":"11797693869"},{"paintseed":"243","item":"9869120702"},{"paintseed":"243","item":"1221391767"},{"paintseed":"702","item":"10363172577"},{"paintseed":"702","item":"7118464586"},{"paintseed":"702","item":"10510513196"},{"paintseed":"702","item":"9088568059"},{"paintseed":"702","item":"11932121126"},{"paintseed":"213","item":"12376770823"},{"paintseed":"213","item":"12205859970"},{"paintseed":"213","item":"10626974219"},{"paintseed":"202","item":"12219704424"},{"paintseed":"202","item":"6280789526"},{"paintseed":"202","item":"10731109908"},{"paintseed":"202","item":"10295313356"},{"paintseed":"202","item":"12564002891"},{"paintseed":"202","item":"12776823078"},{"paintseed":"202","item":"3951803125"},{"paintseed":"202","item":"9516841060"},{"paintseed":"971","item":"12811435656"},{"paintseed":"971","item":"665019269"},{"paintseed":"971","item":"12336618018"},{"paintseed":"971","item":"10220438749"},{"paintseed":"971","item":"12826461056"},{"paintseed":"971","item":"10584045429"},{"paintseed":"971","item":"4774567238"},{"paintseed":"971","item":"5177300120"},{"paintseed":"971","item":"12331678751"},{"paintseed":"188","item":"11541985946"},{"paintseed":"188","item":"12652209102"},{"paintseed":"188","item":"12654651088"},{"paintseed":"188","item":"11880169460"},{"paintseed":"337","item":"12452996480"},{"paintseed":"337","item":"12378038925"},{"paintseed":"337","item":"9424374130"},{"paintseed":"337","item":"5402059509"},{"paintseed":"378","item":"3961843036"},{"paintseed":"378","item":"4568493203"},{"paintseed":"378","item":"12707896566"},{"paintseed":"378","item":"12850350569"},{"paintseed":"378","item":"1698093475"},{"paintseed":"378","item":"9767613815"},{"paintseed":"378","item":"1544303848"},{"paintseed":"378","item":"12013896715"},{"paintseed":"378","item":"12852695801"},{"paintseed":"539","item":"12936982260"},{"paintseed":"539","item":"11059139129"},{"paintseed":"539","item":"12849292681"},{"paintseed":"854","item":"11032052851"},{"paintseed":"854","item":"12341903609"},{"paintseed":"854","item":"9133252241"},{"paintseed":"5","item":"12770961636"},{"paintseed":"5","item":"2611038409"},{"paintseed":"5","item":"8128426534"},{"paintseed":"5","item":"12898109119"},{"paintseed":"966","item":"11175793696"},{"paintseed":"966","item":"12663964838"},{"paintseed":"966","item":"11066299912"},{"paintseed":"966","item":"12432617077"},{"paintseed":"178","item":"8330538063"},{"paintseed":"178","item":"12347997994"},{"paintseed":"178","item":"11759621512"},{"paintseed":"178","item":"8687273925"},{"paintseed":"178","item":"11677126855"},{"paintseed":"178","item":"10545032568"},{"paintseed":"178","item":"12592221267"},{"paintseed":"178","item":"10140986219"},{"paintseed":"696","item":"6789299703"},{"paintseed":"696","item":"11108559647"},{"paintseed":"406","item":"12350947522"},{"paintseed":"406","item":"12298243143"},{"paintseed":"406","item":"11504401309"},{"paintseed":"406","item":"10162239461"},{"paintseed":"406","item":"12936549194"},{"paintseed":"406","item":"12333840085"},{"paintseed":"461","item":"8143543307"},{"paintseed":"461","item":"12643609572"},{"paintseed":"461","item":"70320331"},{"paintseed":"461","item":"9861410590"},{"paintseed":"461","item":"12579837562"},{"paintseed":"922","item":"9804474840"},{"paintseed":"922","item":"6249384431"},{"paintseed":"922","item":"12029806160"},{"paintseed":"922","item":"26306625"},{"paintseed":"922","item":"10054407803"},{"paintseed":"922","item":"11074991686"},{"paintseed":"493","item":"1395626576"},{"paintseed":"493","item":"11498285236"},{"paintseed":"493","item":"8093119156"},{"paintseed":"959","item":"12382298136"},{"paintseed":"959","item":"2286087883"},{"paintseed":"959","item":"11987752225"},{"paintseed":"959","item":"3645920778"},{"paintseed":"959","item":"8270179583"},{"paintseed":"997","item":"9401402016"},{"paintseed":"997","item":"1599657687"},{"paintseed":"997","item":"5035777803"},{"paintseed":"997","item":"10520090363"},{"paintseed":"997","item":"12006569782"},{"paintseed":"997","item":"2336185577"},{"paintseed":"997","item":"11179912791"},{"paintseed":"997","item":"2626698198"},{"paintseed":"997","item":"10753572473"},{"paintseed":"149","item":"6974357538"},{"paintseed":"149","item":"9585397178"},{"paintseed":"149","item":"11830593662"},{"paintseed":"149","item":"12077172269"},{"paintseed":"149","item":"12533298301"},{"paintseed":"149","item":"3978342705"},{"paintseed":"149","item":"6550409505"},{"paintseed":"655","item":"9758400400"},{"paintseed":"655","item":"12707413859"},{"paintseed":"655","item":"12903086320"},{"paintseed":"655","item":"12794987114"},{"paintseed":"655","item":"12870860625"},{"paintseed":"655","item":"7765443586"},{"paintseed":"655","item":"11188019954"},{"paintseed":"171","item":"10850650785"},{"paintseed":"171","item":"8967547995"},{"paintseed":"171","item":"11969870786"},{"paintseed":"171","item":"12109797066"},{"paintseed":"171","item":"4426670328"},{"paintseed":"637","item":"8729123789"},{"paintseed":"637","item":"8494208281"},{"paintseed":"637","item":"8963143325"},{"paintseed":"68","item":"12506571451"},{"paintseed":"68","item":"12823996942"},{"paintseed":"68","item":"12494625822"},{"paintseed":"68","item":"12520921194"},{"paintseed":"287","item":"9227614230"},{"paintseed":"287","item":"12848308774"},{"paintseed":"287","item":"10498556617"},{"paintseed":"287","item":"9880147342"},{"paintseed":"287","item":"5144534383"},{"paintseed":"287","item":"10378079471"},{"paintseed":"656","item":"6151403397"},{"paintseed":"656","item":"10435546007"},{"paintseed":"656","item":"12015792055"},{"paintseed":"656","item":"9928414381"},{"paintseed":"656","item":"2332355676"},{"paintseed":"766","item":"7044481574"},{"paintseed":"766","item":"10522102473"},{"paintseed":"766","item":"4162086337"},{"paintseed":"766","item":"10579113167"},{"paintseed":"766","item":"4342280090"},{"paintseed":"766","item":"11789157047"},{"paintseed":"817","item":"10344137216"},{"paintseed":"817","item":"8868832510"},{"paintseed":"817","item":"7063863919"},{"paintseed":"817","item":"9516763890"},{"paintseed":"817","item":"11050391261"},{"paintseed":"817","item":"6372638735"},{"paintseed":"817","item":"9295288608"},{"paintseed":"165","item":"8168038146"},{"paintseed":"165","item":"9247503948"},{"paintseed":"165","item":"12421008881"},{"paintseed":"165","item":"4801142858"},{"paintseed":"165","item":"11988210367"},{"paintseed":"165","item":"8382049140"},{"paintseed":"165","item":"12486329195"},{"paintseed":"516","item":"5474461203"},{"paintseed":"516","item":"8613034562"},{"paintseed":"370","item":"923675411"},{"paintseed":"370","item":"8627531610"},{"paintseed":"370","item":"11334067271"},{"paintseed":"370","item":"10121768779"},{"paintseed":"370","item":"5729352093"},{"paintseed":"672","item":"9137309162"},{"paintseed":"672","item":"8248940371"},{"paintseed":"672","item":"4614685833"},{"paintseed":"499","item":"5091788232"},{"paintseed":"499","item":"4272670230"},{"paintseed":"499","item":"10289766863"},{"paintseed":"499","item":"6490322459"},{"paintseed":"706","item":"10203505133"},{"paintseed":"706","item":"9015629964"},{"paintseed":"706","item":"11673203341"},{"paintseed":"706","item":"10016686668"},{"paintseed":"706","item":"2820394580"},{"paintseed":"706","item":"12322514952"},{"paintseed":"706","item":"8929787130"},{"paintseed":"706","item":"4174794402"},{"paintseed":"121","item":"3747325746"},{"paintseed":"121","item":"10560678668"},{"paintseed":"121","item":"11100410391"},{"paintseed":"121","item":"6272120232"},{"paintseed":"238","item":"12846086571"},{"paintseed":"238","item":"12141833545"},{"paintseed":"545","item":"10960849836"},{"paintseed":"545","item":"1101280798"},{"paintseed":"545","item":"11038513734"},{"paintseed":"545","item":"12119309766"},{"paintseed":"545","item":"12010651999"},{"paintseed":"206","item":"10861198827"},{"paintseed":"206","item":"5980738092"},{"paintseed":"206","item":"2919697934"},{"paintseed":"206","item":"12914139493"},{"paintseed":"206","item":"6298966259"},{"paintseed":"206","item":"12770327334"},{"paintseed":"206","item":"12666332914"},{"paintseed":"206","item":"12319853570"},{"paintseed":"206","item":"210628740"},{"paintseed":"206","item":"11845382869"},{"paintseed":"206","item":"8122388128"},{"paintseed":"206","item":"12458030963"},{"paintseed":"591","item":"8133890357"},{"paintseed":"591","item":"12859489807"},{"paintseed":"591","item":"12617463024"},{"paintseed":"591","item":"10155949447"},{"paintseed":"591","item":"7181460559"},{"paintseed":"591","item":"10911592235"},{"paintseed":"591","item":"8376152231"},{"paintseed":"546","item":"12106961937"},{"paintseed":"546","item":"10109025928"},{"paintseed":"546","item":"10940925942"},{"paintseed":"177","item":"5408215420"},{"paintseed":"177","item":"7053308358"},{"paintseed":"177","item":"12697751388"},{"paintseed":"177","item":"12745181283"},{"paintseed":"177","item":"11361064195"},{"paintseed":"177","item":"9608020928"},{"paintseed":"177","item":"8019471425"},{"paintseed":"844","item":"10965969688"},{"paintseed":"977","item":"10969849673"},{"paintseed":"977","item":"5880924216"},{"paintseed":"977","item":"10955310666"},{"paintseed":"977","item":"7224827226"},{"paintseed":"977","item":"10131947243"},{"paintseed":"977","item":"10909297965"},{"paintseed":"977","item":"7108019160"},{"paintseed":"589","item":"6139223661"},{"paintseed":"589","item":"11991203557"},{"paintseed":"589","item":"2568828489"},{"paintseed":"589","item":"6884453517"},{"paintseed":"589","item":"11262329413"},{"paintseed":"589","item":"12894840418"},{"paintseed":"589","item":"12930684879"},{"paintseed":"589","item":"12856141897"},{"paintseed":"764","item":"11849617636"},{"paintseed":"764","item":"10686269653"},{"paintseed":"764","item":"9207315339"},{"paintseed":"764","item":"1835356731"},{"paintseed":"764","item":"6974102583"},{"paintseed":"764","item":"10140886722"},{"paintseed":"764","item":"11255826043"},{"paintseed":"764","item":"10815421959"},{"paintseed":"156","item":"2154316653"},{"paintseed":"868","item":"3462660923"},{"paintseed":"868","item":"12350725888"},{"paintseed":"868","item":"4396054995"},{"paintseed":"402","item":"10006063792"},{"paintseed":"402","item":"7090883386"},{"paintseed":"402","item":"9163821035"},{"paintseed":"402","item":"12706894430"},{"paintseed":"725","item":"12045429669"},{"paintseed":"725","item":"12298490224"},{"paintseed":"725","item":"12563453708"},{"paintseed":"725","item":"2820394471"},{"paintseed":"791","item":"7424019340"},{"paintseed":"791","item":"10165052889"},{"paintseed":"858","item":"12429814615"},{"paintseed":"858","item":"12846916302"},{"paintseed":"858","item":"10101048155"},{"paintseed":"858","item":"2065032945"},{"paintseed":"858","item":"5101710878"},{"paintseed":"810","item":"12447177302"},{"paintseed":"810","item":"12773708630"},{"paintseed":"810","item":"10915845374"},{"paintseed":"810","item":"5966284861"},{"paintseed":"553","item":"2914813688"},{"paintseed":"553","item":"11101161022"},{"paintseed":"553","item":"12937650176"},{"paintseed":"553","item":"10775100373"},{"paintseed":"553","item":"12812390814"},{"paintseed":"553","item":"9269180447"},{"paintseed":"553","item":"12469660018"},{"paintseed":"28","item":"3768314090"},{"paintseed":"28","item":"11190219762"},{"paintseed":"28","item":"12544739267"},{"paintseed":"441","item":"11852579963"},{"paintseed":"441","item":"5263587801"},{"paintseed":"972","item":"5921567051"},{"paintseed":"972","item":"1669175542"},{"paintseed":"972","item":"7937359258"},{"paintseed":"972","item":"3683243379"},{"paintseed":"972","item":"11670895465"},{"paintseed":"972","item":"9951507635"},{"paintseed":"972","item":"4960639784"},{"paintseed":"559","item":"5639069395"},{"paintseed":"559","item":"7112627454"},{"paintseed":"559","item":"2842519265"},{"paintseed":"559","item":"1560288410"},{"paintseed":"559","item":"4515764665"},{"paintseed":"559","item":"12638260344"},{"paintseed":"559","item":"9410218631"},{"paintseed":"632","item":"142249562"},{"paintseed":"632","item":"10618227988"},{"paintseed":"632","item":"12653388385"},{"paintseed":"632","item":"6310767812"},{"paintseed":"632","item":"392183075"},{"paintseed":"632","item":"246826869"},{"paintseed":"372","item":"11197539077"},{"paintseed":"372","item":"741227854"},{"paintseed":"329","item":"8395214736"},{"paintseed":"329","item":"12923794078"},{"paintseed":"329","item":"10989959075"},{"paintseed":"329","item":"5905023743"},{"paintseed":"329","item":"906015686"},{"paintseed":"329","item":"10983715513"},{"paintseed":"329","item":"5619317096"},{"paintseed":"329","item":"12915984306"},{"paintseed":"753","item":"7186205757"},{"paintseed":"753","item":"2176870636"},{"paintseed":"753","item":"12743369207"},{"paintseed":"756","item":"6676702053"},{"paintseed":"756","item":"12703451626"},{"paintseed":"756","item":"12670304528"},{"paintseed":"232","item":"12674938112"},{"paintseed":"232","item":"12782747830"},{"paintseed":"232","item":"11152997843"},{"paintseed":"232","item":"11869455387"},{"paintseed":"976","item":"10991020680"},{"paintseed":"976","item":"7231468058"},{"paintseed":"976","item":"12077220420"},{"paintseed":"976","item":"12664741212"},{"paintseed":"976","item":"12914530734"},{"paintseed":"785","item":"5756482791"},{"paintseed":"785","item":"11442298424"},{"paintseed":"785","item":"12416834630"},{"paintseed":"785","item":"12450069147"},{"paintseed":"727","item":"6787618957"},{"paintseed":"90","item":"12659699611"},{"paintseed":"90","item":"12640675558"},{"paintseed":"941","item":"10546911303"},{"paintseed":"941","item":"12675930725"},{"paintseed":"941","item":"12666508011"},{"paintseed":"941","item":"8903029501"},{"paintseed":"351","item":"12297732686"},{"paintseed":"351","item":"11108741921"},{"paintseed":"351","item":"11809402864"},{"paintseed":"351","item":"12436880233"},{"paintseed":"351","item":"10144646257"},{"paintseed":"809","item":"12428369491"},{"paintseed":"809","item":"11197842011"},{"paintseed":"809","item":"5964228668"},{"paintseed":"809","item":"4832512090"},{"paintseed":"805","item":"12344136271"},{"paintseed":"805","item":"8941880651"},{"paintseed":"805","item":"10051476556"},{"paintseed":"805","item":"12264548817"},{"paintseed":"805","item":"4791314492"},{"paintseed":"805","item":"2659394864"},{"paintseed":"805","item":"7386747149"},{"paintseed":"805","item":"9699150917"},{"paintseed":"195","item":"12175725953"},{"paintseed":"195","item":"12464631742"},{"paintseed":"195","item":"2238244127"},{"paintseed":"195","item":"5303757879"},{"paintseed":"590","item":"9475918887"},{"paintseed":"590","item":"9126849664"},{"paintseed":"590","item":"12856600287"},{"paintseed":"590","item":"12413043507"},{"paintseed":"590","item":"5597786906"},{"paintseed":"818","item":"7990293384"},{"paintseed":"818","item":"9463644002"},{"paintseed":"818","item":"12163802033"},{"paintseed":"818","item":"6328063256"},{"paintseed":"818","item":"12725089889"},{"paintseed":"818","item":"11915822909"},{"paintseed":"537","item":"2191210282"},{"paintseed":"537","item":"10254378002"},{"paintseed":"962","item":"12939408326"},{"paintseed":"962","item":"12812566912"},{"paintseed":"962","item":"8599378744"},{"paintseed":"962","item":"12706894334"},{"paintseed":"561","item":"12545391473"},{"paintseed":"561","item":"11793454383"},{"paintseed":"561","item":"6336875697"},{"paintseed":"561","item":"10905600075"},{"paintseed":"561","item":"12421287205"},{"paintseed":"561","item":"12700410758"},{"paintseed":"561","item":"6828872159"},{"paintseed":"561","item":"11744767585"},{"paintseed":"459","item":"8393502734"},{"paintseed":"459","item":"11485855541"},{"paintseed":"27","item":"3421328362"},{"paintseed":"27","item":"12065677477"},{"paintseed":"27","item":"12477805418"},{"paintseed":"27","item":"11848732263"},{"paintseed":"27","item":"7586395124"},{"paintseed":"626","item":"5336174193"},{"paintseed":"626","item":"7580573197"},{"paintseed":"626","item":"12458244426"},{"paintseed":"626","item":"12262842267"},{"paintseed":"710","item":"11816883314"},{"paintseed":"710","item":"11598127643"},{"paintseed":"710","item":"6551314565"},{"paintseed":"710","item":"11806663235"},{"paintseed":"710","item":"12514458858"},{"paintseed":"710","item":"11194143371"},{"paintseed":"710","item":"11642173328"},{"paintseed":"710","item":"11381371552"},{"paintseed":"404","item":"12324893842"},{"paintseed":"404","item":"12490709543"},{"paintseed":"404","item":"12315520768"},{"paintseed":"404","item":"225902762"},{"paintseed":"404","item":"12898359568"},{"paintseed":"404","item":"12801186933"},{"paintseed":"473","item":"3116322232"},{"paintseed":"473","item":"12384827382"},{"paintseed":"473","item":"12456083334"},{"paintseed":"473","item":"11548295207"},{"paintseed":"473","item":"10222011722"},{"paintseed":"473","item":"12370976660"},{"paintseed":"473","item":"9153915434"},{"paintseed":"473","item":"12831454396"},{"paintseed":"397","item":"10109535095"},{"paintseed":"397","item":"10061916725"},{"paintseed":"397","item":"12435840142"},{"paintseed":"483","item":"12680723248"},{"paintseed":"483","item":"7750955606"},{"paintseed":"483","item":"6946080319"},{"paintseed":"930","item":"12236450083"},{"paintseed":"930","item":"10143943888"},{"paintseed":"254","item":"12837246734"},{"paintseed":"254","item":"287058050"},{"paintseed":"254","item":"11782472949"},{"paintseed":"254","item":"11756899889"},{"paintseed":"254","item":"12668794491"},{"paintseed":"125","item":"10828111414"},{"paintseed":"125","item":"11982270783"},{"paintseed":"909","item":"11724582901"},{"paintseed":"909","item":"12399901133"},{"paintseed":"869","item":"12380550386"},{"paintseed":"869","item":"10764188299"},{"paintseed":"869","item":"11381490035"},{"paintseed":"869","item":"10913014147"},{"paintseed":"869","item":"6486006016"},{"paintseed":"869","item":"10013250004"},{"paintseed":"647","item":"12368371490"},{"paintseed":"647","item":"2426986649"},{"paintseed":"647","item":"11440854304"},{"paintseed":"647","item":"689470306"},{"paintseed":"647","item":"12170279575"},{"paintseed":"203","item":"10814288292"},{"paintseed":"203","item":"8184049094"},{"paintseed":"203","item":"10413440113"},{"paintseed":"203","item":"3729275829"},{"paintseed":"183","item":"12279849318"},{"paintseed":"183","item":"9133710144"},{"paintseed":"183","item":"2280509076"},{"paintseed":"183","item":"8501871646"},{"paintseed":"9","item":"9184028077"},{"paintseed":"9","item":"3131758765"},{"paintseed":"9","item":"1590521881"},{"paintseed":"980","item":"12934872394"},{"paintseed":"980","item":"6942532011"},{"paintseed":"980","item":"10405516920"},{"paintseed":"980","item":"2585826449"},{"paintseed":"980","item":"12442168893"},{"paintseed":"980","item":"10074034218"},{"paintseed":"989","item":"12937102365"},{"paintseed":"989","item":"5334199598"},{"paintseed":"989","item":"12722402598"},{"paintseed":"989","item":"8397860222"},{"paintseed":"989","item":"1142459484"},{"paintseed":"989","item":"10629807109"},{"paintseed":"989","item":"7575865756"},{"paintseed":"110","item":"3827606627"},{"paintseed":"110","item":"10800231448"},{"paintseed":"110","item":"8959901682"},{"paintseed":"110","item":"11861977753"},{"paintseed":"110","item":"10101075523"},{"paintseed":"110","item":"10870497353"},{"paintseed":"448","item":"12886560427"},{"paintseed":"448","item":"6861097002"},{"paintseed":"448","item":"12915995188"},{"paintseed":"448","item":"12773792853"},{"paintseed":"448","item":"6271509042"},{"paintseed":"448","item":"5083915269"},{"paintseed":"60","item":"5917969443"},{"paintseed":"60","item":"11110964069"},{"paintseed":"60","item":"9791396379"},{"paintseed":"60","item":"7651694825"},{"paintseed":"60","item":"12846077279"},{"paintseed":"60","item":"7567663101"},{"paintseed":"674","item":"6295677243"},{"paintseed":"674","item":"7795480936"},{"paintseed":"674","item":"947451243"},{"paintseed":"674","item":"9634808605"},{"paintseed":"674","item":"6996750549"},{"paintseed":"674","item":"8994554310"},{"paintseed":"309","item":"7078540631"},{"paintseed":"309","item":"7742516782"},{"paintseed":"309","item":"5865123245"},{"paintseed":"309","item":"12183318549"},{"paintseed":"309","item":"5705518751"},{"paintseed":"309","item":"8546416974"},{"paintseed":"506","item":"11733783021"},{"paintseed":"196","item":"12763911398"},{"paintseed":"196","item":"12506936927"},{"paintseed":"71","item":"3309221155"},{"paintseed":"71","item":"11767809225"},{"paintseed":"71","item":"11335162331"},{"paintseed":"71","item":"8295054674"},{"paintseed":"71","item":"9584205472"},{"paintseed":"400","item":"12432052043"},{"paintseed":"400","item":"12545449404"},{"paintseed":"400","item":"9720229064"},{"paintseed":"216","item":"12171153464"},{"paintseed":"216","item":"12765136349"},{"paintseed":"216","item":"11165550883"},{"paintseed":"216","item":"12835902195"},{"paintseed":"216","item":"9519779342"},{"paintseed":"216","item":"11422211836"},{"paintseed":"315","item":"9651385518"},{"paintseed":"315","item":"901995878"},{"paintseed":"315","item":"4323374440"},{"paintseed":"315","item":"12490379662"},{"paintseed":"315","item":"7759007517"},{"paintseed":"315","item":"10123223237"},{"paintseed":"315","item":"12565882121"},{"paintseed":"315","item":"10827976163"},{"paintseed":"315","item":"7106295467"},{"paintseed":"315","item":"12938924668"},{"paintseed":"315","item":"12843484399"},{"paintseed":"307","item":"2639058266"},{"paintseed":"307","item":"4223943715"},{"paintseed":"485","item":"8070604164"},{"paintseed":"485","item":"11166748382"},{"paintseed":"485","item":"12661161318"},{"paintseed":"485","item":"3366994201"},{"paintseed":"485","item":"11542519154"},{"paintseed":"266","item":"1220566942"},{"paintseed":"266","item":"12912001130"},{"paintseed":"266","item":"8592488424"},{"paintseed":"266","item":"12371968950"},{"paintseed":"266","item":"5717218595"},{"paintseed":"266","item":"12792197758"},{"paintseed":"333","item":"10151455946"},{"paintseed":"333","item":"8582682219"},{"paintseed":"333","item":"4228698898"},{"paintseed":"333","item":"9534015979"},{"paintseed":"333","item":"2613052903"},{"paintseed":"691","item":"9230337791"},{"paintseed":"691","item":"11858572364"},{"paintseed":"691","item":"7535092238"},{"paintseed":"691","item":"285062220"},{"paintseed":"691","item":"8860529346"},{"paintseed":"321","item":"10266427780"},{"paintseed":"321","item":"12506141616"},{"paintseed":"321","item":"8818919040"},{"paintseed":"321","item":"12462451989"},{"paintseed":"328","item":"9797263025"},{"paintseed":"328","item":"10108272647"},{"paintseed":"328","item":"12129369154"},{"paintseed":"328","item":"10268990847"},{"paintseed":"328","item":"12272645603"},{"paintseed":"582","item":"508627554"},{"paintseed":"582","item":"3376031529"},{"paintseed":"582","item":"11310873204"},{"paintseed":"582","item":"8822830095"},{"paintseed":"582","item":"4877300852"},{"paintseed":"582","item":"4546615878"},{"paintseed":"234","item":"9174292071"},{"paintseed":"234","item":"12939626115"},{"paintseed":"234","item":"8698885024"},{"paintseed":"234","item":"7218996475"},{"paintseed":"234","item":"7806543145"},{"paintseed":"496","item":"12482065000"},{"paintseed":"496","item":"5562240522"},{"paintseed":"496","item":"3426868907"},{"paintseed":"496","item":"3175883666"},{"paintseed":"496","item":"7680531272"},{"paintseed":"496","item":"12613037447"},{"paintseed":"948","item":"12436778422"},{"paintseed":"948","item":"11556881603"},{"paintseed":"535","item":"12768888469"},{"paintseed":"535","item":"7197912821"},{"paintseed":"535","item":"5955625491"},{"paintseed":"535","item":"12852461057"},{"paintseed":"535","item":"5130399998"},{"paintseed":"535","item":"8804953988"},{"paintseed":"535","item":"1319308538"}]');
        foreach ($patterns as $pattern){
                Paintseed::create(['item_id' => $pattern->item, 'value' => $pattern->paintseed]);
        }

        return 'OK';
    }

    public function getSteam()
    {
        $tasks = Task::with('item')->where('pattern', '!=', null)->where('client', '=', 'ska4an')
            ->where('site_id', '=', '7')->get();

        $paintseeds = [];
        foreach ($tasks as $task){
            $paterns = $task->item->patterns->where('name', '=', $task->pattern)->toArray();
            foreach ($paterns as $patern){
                $paintseeds[] = $patern['value'];

            }
        }
        $steam_ids = DB::table('paintseeds')->whereIn('value',$paintseeds)->distinct()->pluck('item_id')->toArray();

        return json_encode($steam_ids);

    }
}
