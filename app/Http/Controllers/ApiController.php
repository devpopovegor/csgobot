<?php

namespace App\Http\Controllers;

use App\Item;
use App\Paintseed;
use App\Pattern;
use App\Task;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\DB;
use Illuminate\Support\Facades\Log;
use Telegram\Bot\Laravel\Facades\Telegram;

class ApiController extends Controller
{
    public function addItem()
    {
        $name = $_GET['name'];
        $phase = $_GET['phase'] ? $_GET['phase'] : '';
        $float = $_GET['float'];
        $pattern = $_GET['pattern'];
        $item = Item::where('name', '=', $name)->where('phase', '=', $phase)->first();
        if ($item){
            if (Task::where('item_id', '=', $item->id)->where('client','=','ska4an')
                ->where('site_id', '=', 7)->where('float', '=', $float)->where('pattern', '=', $pattern)->first()){
                return "Search already exists";
            }
        }
        else {
            return "Item not exists";
        }

        Task::create(['item_id' => $item->id, 'site_id' => 7, 'float' => $float, 'client' => 'ska4an', 'pattern' => $pattern, 'chat_id' => '']);
        return "OK";
    }

    public function getList()
    {
        $tasks = json_encode(Task::with('item')->where('site_id', '=', '7')
            ->where('client','=', 'ska4an')->get());

        return json_encode($tasks);
    }

    public function getPatterns()
    {
        return json_encode(Pattern::all());
    }

    public function send()
    {
    	$item = Item::find($_GET['item_id']);
	    Telegram::sendMessage([
		    'chat_id' => 222881167,
		    'text' => "Бот для cs.money отправил оффер на {$item->full_name}",
		    'parse_mode' => 'HTML'
	    ]);

	    return json_encode('ok');
    }

    public function setPatterns()
    {
        set_time_limit(0);
        $patterns = json_decode('[{"paintseed":"387","item":"6413950068"},{"paintseed":"387","item":"12124075352"},{"paintseed":"387","item":"8984404232"},{"paintseed":"387","item":"12916332577"},{"paintseed":"387","item":"8777387549"},{"paintseed":"387","item":"12773348707"},{"paintseed":"387","item":"3314060447"},{"paintseed":"853","item":"12819629378"},{"paintseed":"853","item":"12859696220"},{"paintseed":"853","item":"11576198014"},{"paintseed":"853","item":"6012502454"},{"paintseed":"853","item":"12516255309"},{"paintseed":"853","item":"8455304593"},{"paintseed":"853","item":"12883271194"},{"paintseed":"442","item":"10868724234"},{"paintseed":"442","item":"9487171686"},{"paintseed":"442","item":"10179759003"},{"paintseed":"269","item":"7295084706"},{"paintseed":"269","item":"3340346419"},{"paintseed":"269","item":"10016521921"},{"paintseed":"269","item":"12639220821"},{"paintseed":"269","item":"12522102717"},{"paintseed":"269","item":"2336992053"},{"paintseed":"269","item":"12897105001"},{"paintseed":"269","item":"12263799139"},{"paintseed":"269","item":"12926119846"},{"paintseed":"470","item":"6071300602"},{"paintseed":"470","item":"10660660611"},{"paintseed":"470","item":"12894565633"},{"paintseed":"470","item":"3373902699"},{"paintseed":"470","item":"12846458599"},{"paintseed":"470","item":"12790739724"},{"paintseed":"776","item":"5590703141"},{"paintseed":"776","item":"9303425254"},{"paintseed":"776","item":"5966532738"},{"paintseed":"776","item":"12817209904"},{"paintseed":"776","item":"12920753050"},{"paintseed":"776","item":"12312014280"},{"paintseed":"776","item":"12836805884"},{"paintseed":"809","item":"3536182433"},{"paintseed":"809","item":"12400734660"},{"paintseed":"809","item":"11430711863"},{"paintseed":"809","item":"12491890994"},{"paintseed":"809","item":"6394467344"},{"paintseed":"809","item":"11424398473"},{"paintseed":"73","item":"12899582344"},{"paintseed":"73","item":"11515051195"},{"paintseed":"73","item":"10943157028"},{"paintseed":"73","item":"12204143878"},{"paintseed":"888","item":"10570376180"},{"paintseed":"902","item":"12837901006"},{"paintseed":"902","item":"10665319859"},{"paintseed":"902","item":"12753644532"},{"paintseed":"905","item":"5629782432"},{"paintseed":"905","item":"12859238512"},{"paintseed":"905","item":"10985214581"},{"paintseed":"905","item":"12937447331"},{"paintseed":"905","item":"12883271202"},{"paintseed":"905","item":"10570376214"},{"paintseed":"905","item":"11976921413"},{"paintseed":"463","item":"7917999969"},{"paintseed":"463","item":"7931146737"},{"paintseed":"463","item":"12371502147"},{"paintseed":"463","item":"12303112249"},{"paintseed":"463","item":"12782446962"},{"paintseed":"463","item":"4150232132"},{"paintseed":"463","item":"12796470656"},{"paintseed":"82","item":"10946757540"},{"paintseed":"82","item":"7006763659"},{"paintseed":"82","item":"12746733983"},{"paintseed":"510","item":"10517164785"},{"paintseed":"510","item":"11902476876"},{"paintseed":"510","item":"12273948471"},{"paintseed":"510","item":"4401487955"},{"paintseed":"510","item":"12925359603"},{"paintseed":"510","item":"12902473116"},{"paintseed":"510","item":"9699710670"},{"paintseed":"510","item":"11369629576"},{"paintseed":"256","item":"8704699481"},{"paintseed":"256","item":"4746932867"},{"paintseed":"256","item":"4674709135"},{"paintseed":"256","item":"8011607572"},{"paintseed":"256","item":"12439307498"},{"paintseed":"453","item":"12531575734"},{"paintseed":"453","item":"9775450648"},{"paintseed":"321","item":"9421932597"},{"paintseed":"321","item":"12777488365"},{"paintseed":"321","item":"10718305385"},{"paintseed":"321","item":"12536023559"},{"paintseed":"727","item":"11112494624"},{"paintseed":"727","item":"12925569804"},{"paintseed":"727","item":"1453011730"},{"paintseed":"727","item":"12817209917"},{"paintseed":"727","item":"12850660716"},{"paintseed":"727","item":"12020220187"},{"paintseed":"727","item":"7302944663"},{"paintseed":"130","item":"11041717164"},{"paintseed":"130","item":"10701937911"},{"paintseed":"130","item":"9685375345"},{"paintseed":"375","item":"12338297953"},{"paintseed":"74","item":"8650795193"},{"paintseed":"74","item":"12160419438"},{"paintseed":"74","item":"922767050"},{"paintseed":"74","item":"2845956676"},{"paintseed":"74","item":"10860460844"},{"paintseed":"74","item":"12900208445"},{"paintseed":"868","item":"12508262754"},{"paintseed":"868","item":"12869822692"},{"paintseed":"868","item":"11473811241"},{"paintseed":"541","item":"12843574338"},{"paintseed":"914","item":"12682858937"},{"paintseed":"914","item":"6091052404"},{"paintseed":"914","item":"12474329347"},{"paintseed":"698","item":"12209252594"},{"paintseed":"698","item":"8021504649"},{"paintseed":"698","item":"12837177806"},{"paintseed":"341","item":"8497215621"},{"paintseed":"811","item":"12704757698"},{"paintseed":"811","item":"12507075493"},{"paintseed":"811","item":"12876404069"},{"paintseed":"322","item":"11623620073"},{"paintseed":"322","item":"3873679627"},{"paintseed":"322","item":"12490897685"},{"paintseed":"322","item":"12444916059"},{"paintseed":"322","item":"5878200899"},{"paintseed":"322","item":"3723706562"},{"paintseed":"273","item":"7797764515"},{"paintseed":"273","item":"3399368153"},{"paintseed":"273","item":"12456740893"},{"paintseed":"273","item":"10308081994"},{"paintseed":"273","item":"10300544187"},{"paintseed":"273","item":"12755500081"},{"paintseed":"273","item":"5777171082"},{"paintseed":"798","item":"12445006779"},{"paintseed":"798","item":"12441925067"},{"paintseed":"798","item":"11165176629"},{"paintseed":"798","item":"11234617680"},{"paintseed":"798","item":"12067903722"},{"paintseed":"798","item":"11884632982"},{"paintseed":"798","item":"12914132868"},{"paintseed":"798","item":"12508267992"},{"paintseed":"798","item":"8432280267"},{"paintseed":"798","item":"12001185258"},{"paintseed":"664","item":"12587348581"},{"paintseed":"664","item":"2857513590"},{"paintseed":"664","item":"11111546002"},{"paintseed":"664","item":"12815356221"},{"paintseed":"664","item":"5856843467"},{"paintseed":"664","item":"11051068115"},{"paintseed":"664","item":"9315101677"},{"paintseed":"664","item":"10159834206"},{"paintseed":"664","item":"11841402099"},{"paintseed":"664","item":"12847687285"},{"paintseed":"92","item":"6622022512"},{"paintseed":"92","item":"6712516352"},{"paintseed":"92","item":"8334805281"},{"paintseed":"721","item":"4172276745"},{"paintseed":"721","item":"1328410202"},{"paintseed":"721","item":"9076861157"},{"paintseed":"721","item":"12860147363"},{"paintseed":"721","item":"12489873034"},{"paintseed":"721","item":"12468112403"},{"paintseed":"721","item":"8391097664"},{"paintseed":"494","item":"12751281769"},{"paintseed":"494","item":"11373163188"},{"paintseed":"494","item":"9976428613"},{"paintseed":"713","item":"6570470608"},{"paintseed":"713","item":"12565809765"},{"paintseed":"713","item":"12255085730"},{"paintseed":"57","item":"4577456310"},{"paintseed":"57","item":"11211810743"},{"paintseed":"25","item":"12003268852"},{"paintseed":"25","item":"12718536941"},{"paintseed":"25","item":"10695824237"},{"paintseed":"25","item":"9177011086"},{"paintseed":"25","item":"6596858856"},{"paintseed":"25","item":"12125691338"},{"paintseed":"580","item":"12793341861"},{"paintseed":"580","item":"3078295505"},{"paintseed":"580","item":"7185124427"},{"paintseed":"34","item":"12892657046"},{"paintseed":"770","item":"11001314588"},{"paintseed":"770","item":"11098804113"},{"paintseed":"770","item":"11672806857"},{"paintseed":"770","item":"4641075793"},{"paintseed":"282","item":"12917867246"},{"paintseed":"282","item":"9581537953"},{"paintseed":"282","item":"12932317628"},{"paintseed":"282","item":"9810303818"},{"paintseed":"282","item":"10618070531"},{"paintseed":"139","item":"12444916044"},{"paintseed":"139","item":"12820976092"},{"paintseed":"139","item":"6409498716"},{"paintseed":"139","item":"12937114125"},{"paintseed":"139","item":"12673229679"},{"paintseed":"262","item":"11103275187"},{"paintseed":"262","item":"10905365020"},{"paintseed":"262","item":"11279753304"},{"paintseed":"856","item":"10772680702"},{"paintseed":"856","item":"7391191676"},{"paintseed":"856","item":"12796906360"},{"paintseed":"856","item":"6197286339"},{"paintseed":"856","item":"9685385402"},{"paintseed":"856","item":"11223401982"},{"paintseed":"856","item":"7586007142"},{"paintseed":"152","item":"12227651717"},{"paintseed":"152","item":"12659708512"},{"paintseed":"152","item":"10959278252"},{"paintseed":"152","item":"9237561726"},{"paintseed":"152","item":"10837817873"},{"paintseed":"152","item":"12937565916"},{"paintseed":"152","item":"5343304335"},{"paintseed":"152","item":"12921395598"},{"paintseed":"152","item":"12795676118"},{"paintseed":"265","item":"5708912306"},{"paintseed":"265","item":"10143282174"},{"paintseed":"265","item":"12482359830"},{"paintseed":"265","item":"11332783047"},{"paintseed":"265","item":"8573745908"},{"paintseed":"265","item":"12183370873"},{"paintseed":"265","item":"9658793281"},{"paintseed":"265","item":"12106442364"},{"paintseed":"265","item":"8618975158"},{"paintseed":"265","item":"7510811389"},{"paintseed":"323","item":"10319910480"},{"paintseed":"323","item":"10708917828"},{"paintseed":"323","item":"12513417659"},{"paintseed":"323","item":"4464806947"},{"paintseed":"323","item":"9020993719"},{"paintseed":"323","item":"9793415561"},{"paintseed":"323","item":"12406214081"},{"paintseed":"323","item":"8905189574"},{"paintseed":"891","item":"7879532466"},{"paintseed":"891","item":"7807603574"},{"paintseed":"891","item":"12519623634"},{"paintseed":"989","item":"12939241091"},{"paintseed":"989","item":"9661088212"},{"paintseed":"989","item":"10767708523"},{"paintseed":"989","item":"11314884208"},{"paintseed":"989","item":"9329764617"},{"paintseed":"989","item":"12645370392"},{"paintseed":"138","item":"4828540781"},{"paintseed":"138","item":"12740270772"},{"paintseed":"138","item":"12230736254"},{"paintseed":"841","item":"12891980460"},{"paintseed":"841","item":"7736583964"},{"paintseed":"30","item":"9480158733"},{"paintseed":"30","item":"5930253391"},{"paintseed":"30","item":"5503606193"},{"paintseed":"30","item":"10692274923"},{"paintseed":"30","item":"8401303348"},{"paintseed":"30","item":"1786638132"},{"paintseed":"30","item":"6951028738"},{"paintseed":"20","item":"10061911665"},{"paintseed":"20","item":"12116902697"},{"paintseed":"20","item":"4608393683"},{"paintseed":"20","item":"12362703264"},{"paintseed":"20","item":"11477648827"},{"paintseed":"4","item":"12843552644"},{"paintseed":"4","item":"10605273881"},{"paintseed":"4","item":"11720273261"},{"paintseed":"4","item":"1991746214"},{"paintseed":"4","item":"353103853"},{"paintseed":"955","item":"12704231657"},{"paintseed":"955","item":"11798050671"},{"paintseed":"955","item":"6857303190"},{"paintseed":"955","item":"11063709602"},{"paintseed":"955","item":"3417538679"},{"paintseed":"823","item":"7044092489"},{"paintseed":"823","item":"9760441180"},{"paintseed":"823","item":"5730459027"},{"paintseed":"823","item":"4217508853"},{"paintseed":"330","item":"12389200964"},{"paintseed":"330","item":"12532967736"},{"paintseed":"330","item":"11212743262"},{"paintseed":"330","item":"12828619137"},{"paintseed":"330","item":"12477327334"},{"paintseed":"330","item":"11768508286"},{"paintseed":"330","item":"12220598279"},{"paintseed":"965","item":"9012577240"},{"paintseed":"965","item":"12158955472"},{"paintseed":"965","item":"11953217975"},{"paintseed":"965","item":"7415426361"},{"paintseed":"965","item":"12811334269"},{"paintseed":"965","item":"10478954759"},{"paintseed":"965","item":"10009489559"},{"paintseed":"182","item":"6998923957"},{"paintseed":"182","item":"10470960587"},{"paintseed":"182","item":"6150954891"},{"paintseed":"182","item":"12885435719"},{"paintseed":"838","item":"12765261602"},{"paintseed":"838","item":"6990890018"},{"paintseed":"838","item":"9829819792"},{"paintseed":"11","item":"11770375036"},{"paintseed":"11","item":"2770809470"},{"paintseed":"11","item":"4798875968"},{"paintseed":"11","item":"12720054179"},{"paintseed":"11","item":"10736227450"},{"paintseed":"631","item":"3247518795"},{"paintseed":"631","item":"12883227164"},{"paintseed":"631","item":"12546611858"},{"paintseed":"631","item":"7750975409"},{"paintseed":"631","item":"12898727700"},{"paintseed":"917","item":"10630097819"},{"paintseed":"917","item":"9034053997"},{"paintseed":"917","item":"11693282501"},{"paintseed":"917","item":"11502896461"},{"paintseed":"917","item":"12874160200"},{"paintseed":"917","item":"12913813522"},{"paintseed":"917","item":"12790860863"},{"paintseed":"575","item":"10700528849"},{"paintseed":"575","item":"11743581647"},{"paintseed":"575","item":"12901211460"},{"paintseed":"575","item":"359754783"},{"paintseed":"575","item":"12877838761"},{"paintseed":"661","item":"5991748641"},{"paintseed":"661","item":"5532267860"},{"paintseed":"661","item":"9696266006"},{"paintseed":"661","item":"3801172219"},{"paintseed":"661","item":"12487679251"},{"paintseed":"661","item":"2900818991"},{"paintseed":"670","item":"10035349102"},{"paintseed":"670","item":"12756239974"},{"paintseed":"670","item":"6685491365"},{"paintseed":"670","item":"12362703225"},{"paintseed":"670","item":"10846785328"},{"paintseed":"670","item":"6942117516"},{"paintseed":"852","item":"12547144103"},{"paintseed":"852","item":"3466361908"},{"paintseed":"852","item":"7935601613"},{"paintseed":"852","item":"7424050037"},{"paintseed":"852","item":"12868349409"},{"paintseed":"852","item":"6492410625"},{"paintseed":"852","item":"12424016742"},{"paintseed":"852","item":"10787846193"},{"paintseed":"852","item":"12638996190"},{"paintseed":"852","item":"12478983470"},{"paintseed":"112","item":"10190432687"},{"paintseed":"112","item":"12170242026"},{"paintseed":"112","item":"5718762143"},{"paintseed":"112","item":"9393008354"},{"paintseed":"509","item":"10318767305"},{"paintseed":"509","item":"5969574027"},{"paintseed":"509","item":"6298707535"},{"paintseed":"509","item":"12907656803"},{"paintseed":"509","item":"6845152776"},{"paintseed":"509","item":"11797216234"},{"paintseed":"509","item":"12878542671"},{"paintseed":"426","item":"12880948534"},{"paintseed":"426","item":"12832753491"},{"paintseed":"426","item":"8851052933"},{"paintseed":"782","item":"320558717"},{"paintseed":"782","item":"12397777612"},{"paintseed":"782","item":"12393515225"},{"paintseed":"782","item":"12295272624"},{"paintseed":"782","item":"11606313659"},{"paintseed":"782","item":"7528748205"},{"paintseed":"711","item":"11905841818"},{"paintseed":"711","item":"1700672484"},{"paintseed":"711","item":"2701671270"},{"paintseed":"711","item":"11047744346"},{"paintseed":"711","item":"12585370564"},{"paintseed":"711","item":"12541057198"},{"paintseed":"711","item":"12133036523"},{"paintseed":"711","item":"7889604645"},{"paintseed":"711","item":"11974119146"},{"paintseed":"655","item":"10482657498"},{"paintseed":"655","item":"3831988367"},{"paintseed":"655","item":"12484221853"},{"paintseed":"655","item":"10527755783"},{"paintseed":"655","item":"11858004966"},{"paintseed":"655","item":"5384731655"},{"paintseed":"655","item":"12245147807"},{"paintseed":"515","item":"10436398247"},{"paintseed":"515","item":"725196414"},{"paintseed":"515","item":"11342655764"},{"paintseed":"515","item":"10771615635"},{"paintseed":"828","item":"12885879226"},{"paintseed":"828","item":"7405224999"},{"paintseed":"828","item":"7186671240"},{"paintseed":"828","item":"9817705606"},{"paintseed":"828","item":"5590951437"},{"paintseed":"828","item":"11923608314"},{"paintseed":"828","item":"4173497648"},{"paintseed":"643","item":"10233810451"},{"paintseed":"643","item":"9156938407"},{"paintseed":"643","item":"12928691162"},{"paintseed":"643","item":"12547712149"},{"paintseed":"643","item":"6074086754"},{"paintseed":"643","item":"12323745855"},{"paintseed":"643","item":"12229086442"},{"paintseed":"310","item":"12847611239"},{"paintseed":"310","item":"12797221187"},{"paintseed":"310","item":"12821018341"},{"paintseed":"38","item":"8068988809"},{"paintseed":"38","item":"8932282546"},{"paintseed":"38","item":"12447852775"},{"paintseed":"38","item":"5137306416"},{"paintseed":"499","item":"9012577226"},{"paintseed":"499","item":"5953517401"},{"paintseed":"499","item":"9059397951"},{"paintseed":"499","item":"12530234379"},{"paintseed":"499","item":"12074922570"},{"paintseed":"499","item":"12870550442"},{"paintseed":"499","item":"12775628484"},{"paintseed":"499","item":"6846334406"},{"paintseed":"499","item":"12659969326"},{"paintseed":"236","item":"8694152291"},{"paintseed":"236","item":"11611297042"},{"paintseed":"236","item":"12843085566"},{"paintseed":"236","item":"12620004088"},{"paintseed":"236","item":"4694836641"},{"paintseed":"236","item":"12847538318"},{"paintseed":"236","item":"9307771363"},{"paintseed":"490","item":"8820733017"},{"paintseed":"490","item":"12506197748"},{"paintseed":"490","item":"4829527010"},{"paintseed":"490","item":"9854879865"},{"paintseed":"490","item":"11003950221"},{"paintseed":"490","item":"10187649201"},{"paintseed":"490","item":"11502380315"},{"paintseed":"490","item":"12518033479"},{"paintseed":"490","item":"4118845442"},{"paintseed":"844","item":"9635720853"},{"paintseed":"844","item":"3861083613"},{"paintseed":"413","item":"12535658413"},{"paintseed":"413","item":"1122979503"},{"paintseed":"413","item":"12679153332"},{"paintseed":"413","item":"4960821354"},{"paintseed":"413","item":"11985778317"},{"paintseed":"413","item":"7894450623"},{"paintseed":"595","item":"12466459918"},{"paintseed":"595","item":"12432388878"},{"paintseed":"595","item":"10833597990"},{"paintseed":"595","item":"12926377902"},{"paintseed":"595","item":"4335159287"},{"paintseed":"595","item":"12928885542"},{"paintseed":"595","item":"9531831132"},{"paintseed":"106","item":"6607448747"},{"paintseed":"106","item":"11926946154"},{"paintseed":"106","item":"11390244822"},{"paintseed":"106","item":"10765123567"},{"paintseed":"919","item":"1222567804"},{"paintseed":"919","item":"9452289601"},{"paintseed":"303","item":"7777045635"},{"paintseed":"303","item":"9424986413"},{"paintseed":"303","item":"11173566066"},{"paintseed":"303","item":"6311105103"},{"paintseed":"303","item":"12839780768"},{"paintseed":"450","item":"12730511960"},{"paintseed":"450","item":"2398859667"},{"paintseed":"450","item":"10406029077"},{"paintseed":"450","item":"5628265616"},{"paintseed":"450","item":"11389646836"},{"paintseed":"335","item":"6071028699"},{"paintseed":"335","item":"9719154259"},{"paintseed":"335","item":"12522528053"},{"paintseed":"335","item":"11975306223"},{"paintseed":"306","item":"7990436275"},{"paintseed":"306","item":"11882885413"},{"paintseed":"306","item":"8299984815"},{"paintseed":"306","item":"12768583246"},{"paintseed":"306","item":"11971962084"},{"paintseed":"488","item":"11767047817"},{"paintseed":"488","item":"11576113896"},{"paintseed":"488","item":"8807947282"},{"paintseed":"488","item":"8329092109"},{"paintseed":"488","item":"5325281811"},{"paintseed":"488","item":"7468280096"},{"paintseed":"488","item":"11843889638"},{"paintseed":"694","item":"12240055837"},{"paintseed":"694","item":"12395296769"},{"paintseed":"694","item":"12700289096"},{"paintseed":"694","item":"8752877400"},{"paintseed":"216","item":"10135407535"},{"paintseed":"216","item":"6202735311"},{"paintseed":"216","item":"5643268500"},{"paintseed":"216","item":"12898011554"},{"paintseed":"216","item":"12307237534"},{"paintseed":"796","item":"7309728043"},{"paintseed":"796","item":"12736391679"},{"paintseed":"796","item":"9046658476"},{"paintseed":"796","item":"5123213997"},{"paintseed":"405","item":"865496825"},{"paintseed":"405","item":"12545082463"},{"paintseed":"942","item":"3708304586"},{"paintseed":"942","item":"5127715254"},{"paintseed":"942","item":"12600931376"},{"paintseed":"942","item":"9980151416"},{"paintseed":"942","item":"11289383716"},{"paintseed":"942","item":"9905733652"},{"paintseed":"942","item":"9046690296"},{"paintseed":"109","item":"12137386114"},{"paintseed":"109","item":"10381170102"},{"paintseed":"916","item":"12806997936"},{"paintseed":"916","item":"12412747252"},{"paintseed":"916","item":"3853740717"},{"paintseed":"916","item":"12882464702"},{"paintseed":"916","item":"4596662132"},{"paintseed":"916","item":"11671911091"},{"paintseed":"916","item":"9942210490"},{"paintseed":"522","item":"12860296121"},{"paintseed":"522","item":"12483837871"},{"paintseed":"522","item":"9725262477"},{"paintseed":"522","item":"12781352489"},{"paintseed":"154","item":"10415871722"},{"paintseed":"154","item":"10270455150"},{"paintseed":"154","item":"12753192143"},{"paintseed":"371","item":"12876427893"},{"paintseed":"371","item":"5797163630"},{"paintseed":"371","item":"8959330077"},{"paintseed":"638","item":"9699151240"},{"paintseed":"638","item":"12471335097"},{"paintseed":"638","item":"10738813984"},{"paintseed":"638","item":"12445592613"},{"paintseed":"638","item":"5252943495"},{"paintseed":"615","item":"12754737338"},{"paintseed":"615","item":"8047464186"},{"paintseed":"615","item":"3630151274"},{"paintseed":"398","item":"10450395079"},{"paintseed":"398","item":"9506164703"},{"paintseed":"398","item":"96257637"},{"paintseed":"398","item":"12637988194"},{"paintseed":"398","item":"11140748819"},{"paintseed":"398","item":"10390643631"},{"paintseed":"803","item":"12119309703"},{"paintseed":"803","item":"6194593198"},{"paintseed":"803","item":"12729649460"},{"paintseed":"803","item":"12830697495"},{"paintseed":"637","item":"12230387185"},{"paintseed":"637","item":"12373122023"},{"paintseed":"637","item":"12172059459"},{"paintseed":"637","item":"10951712251"},{"paintseed":"637","item":"12836529456"},{"paintseed":"766","item":"7835251183"},{"paintseed":"766","item":"12523151604"},{"paintseed":"766","item":"9667388825"},{"paintseed":"766","item":"4645232682"},{"paintseed":"766","item":"2557316400"},{"paintseed":"766","item":"12684088801"},{"paintseed":"728","item":"12917057520"},{"paintseed":"728","item":"9641615158"},{"paintseed":"728","item":"10320402058"},{"paintseed":"194","item":"11576010868"},{"paintseed":"194","item":"4125221855"},{"paintseed":"194","item":"3688749113"},{"paintseed":"194","item":"12733980841"},{"paintseed":"194","item":"9874147663"},{"paintseed":"429","item":"10011587792"},{"paintseed":"429","item":"12884113055"},{"paintseed":"429","item":"8467056339"},{"paintseed":"429","item":"892946209"},{"paintseed":"429","item":"7159672083"},{"paintseed":"429","item":"2072634328"},{"paintseed":"284","item":"9796886297"},{"paintseed":"284","item":"12643930844"},{"paintseed":"284","item":"11725374747"},{"paintseed":"284","item":"8681228843"},{"paintseed":"177","item":"7224416554"},{"paintseed":"177","item":"7541895604"},{"paintseed":"177","item":"11521799463"},{"paintseed":"177","item":"9912540163"},{"paintseed":"177","item":"12739069880"},{"paintseed":"945","item":"11274112439"},{"paintseed":"945","item":"2045756922"},{"paintseed":"945","item":"8038796271"},{"paintseed":"945","item":"12820279143"},{"paintseed":"945","item":"6408513441"},{"paintseed":"945","item":"10154178985"},{"paintseed":"860","item":"12453851273"},{"paintseed":"860","item":"11849606641"},{"paintseed":"860","item":"7744612734"},{"paintseed":"860","item":"10296532180"},{"paintseed":"860","item":"5081931853"},{"paintseed":"860","item":"10019972537"},{"paintseed":"860","item":"11121843334"},{"paintseed":"860","item":"6245888923"},{"paintseed":"334","item":"9699151872"},{"paintseed":"334","item":"7843134113"},{"paintseed":"334","item":"12558348480"},{"paintseed":"334","item":"12939408308"},{"paintseed":"334","item":"2829832833"},{"paintseed":"334","item":"2463623244"},{"paintseed":"334","item":"10193286255"},{"paintseed":"246","item":"9679913653"},{"paintseed":"246","item":"9409719736"},{"paintseed":"246","item":"11928137198"},{"paintseed":"246","item":"9246866799"},{"paintseed":"246","item":"7031061456"},{"paintseed":"246","item":"12372664542"},{"paintseed":"985","item":"10401537299"},{"paintseed":"985","item":"12742984433"},{"paintseed":"985","item":"4174095495"},{"paintseed":"985","item":"8974595579"},{"paintseed":"985","item":"8603791619"},{"paintseed":"42","item":"3293840271"},{"paintseed":"42","item":"9526163862"},{"paintseed":"42","item":"12536531261"},{"paintseed":"42","item":"9182769010"},{"paintseed":"42","item":"7968723853"},{"paintseed":"42","item":"8703535591"},{"paintseed":"244","item":"11738496027"},{"paintseed":"244","item":"12031567083"},{"paintseed":"244","item":"6590307322"},{"paintseed":"244","item":"11644823165"},{"paintseed":"935","item":"9182427474"},{"paintseed":"935","item":"10479581978"},{"paintseed":"935","item":"10013582725"},{"paintseed":"935","item":"12409862316"},{"paintseed":"935","item":"5396967208"},{"paintseed":"935","item":"7028921858"},{"paintseed":"935","item":"5530120600"},{"paintseed":"974","item":"2658520687"},{"paintseed":"974","item":"6555601799"},{"paintseed":"974","item":"9641206749"},{"paintseed":"974","item":"6094907205"},{"paintseed":"974","item":"7046903583"},{"paintseed":"974","item":"12659445262"},{"paintseed":"179","item":"10593614793"},{"paintseed":"179","item":"12855024289"},{"paintseed":"179","item":"8429044253"},{"paintseed":"179","item":"12913727745"},{"paintseed":"179","item":"12761942389"},{"paintseed":"598","item":"9085305320"},{"paintseed":"598","item":"12895046445"},{"paintseed":"598","item":"5548906343"},{"paintseed":"598","item":"8935487487"},{"paintseed":"598","item":"9760044710"},{"paintseed":"676","item":"7442888246"},{"paintseed":"676","item":"11502895981"},{"paintseed":"676","item":"4938106239"},{"paintseed":"676","item":"12046952002"},{"paintseed":"676","item":"6170165882"},{"paintseed":"676","item":"10567733804"},{"paintseed":"676","item":"10147142345"},{"paintseed":"676","item":"11806414089"},{"paintseed":"676","item":"9285274127"},{"paintseed":"676","item":"4792957201"},{"paintseed":"676","item":"6172608061"},{"paintseed":"676","item":"11519574750"},{"paintseed":"644","item":"7958745923"},{"paintseed":"644","item":"8125820784"},{"paintseed":"644","item":"12425448410"},{"paintseed":"122","item":"12806227176"},{"paintseed":"122","item":"7247066058"},{"paintseed":"122","item":"8709015448"},{"paintseed":"122","item":"8384829599"},{"paintseed":"122","item":"12670965060"},{"paintseed":"563","item":"9490333582"},{"paintseed":"563","item":"12731150176"},{"paintseed":"563","item":"9075663338"},{"paintseed":"563","item":"12884788109"},{"paintseed":"563","item":"12148183255"},{"paintseed":"563","item":"12362703197"},{"paintseed":"128","item":"10555601208"},{"paintseed":"128","item":"12210611337"},{"paintseed":"128","item":"12239601806"},{"paintseed":"128","item":"10654680107"},{"paintseed":"128","item":"12862831576"},{"paintseed":"128","item":"11724280454"},{"paintseed":"571","item":"9804828882"},{"paintseed":"571","item":"10110532099"},{"paintseed":"571","item":"2381646475"},{"paintseed":"571","item":"9900269237"},{"paintseed":"571","item":"1285665146"},{"paintseed":"571","item":"5383341253"},{"paintseed":"767","item":"2868932073"},{"paintseed":"767","item":"12912271035"},{"paintseed":"767","item":"5683280270"},{"paintseed":"953","item":"12244192314"},{"paintseed":"953","item":"11453524082"},{"paintseed":"953","item":"8755831289"},{"paintseed":"953","item":"10032273724"},{"paintseed":"953","item":"5163686035"},{"paintseed":"547","item":"9865232935"},{"paintseed":"547","item":"9267941074"},{"paintseed":"547","item":"6786627306"},{"paintseed":"547","item":"12222552071"},{"paintseed":"547","item":"12155292035"},{"paintseed":"961","item":"5264416271"},{"paintseed":"961","item":"4675685752"},{"paintseed":"849","item":"7347343444"},{"paintseed":"849","item":"4601523708"},{"paintseed":"259","item":"11135736632"},{"paintseed":"259","item":"10379882528"},{"paintseed":"259","item":"6729739557"},{"paintseed":"875","item":"12424256141"},{"paintseed":"875","item":"10262980140"},{"paintseed":"875","item":"9467538238"},{"paintseed":"875","item":"8962052379"},{"paintseed":"875","item":"7568525093"},{"paintseed":"875","item":"9858305157"},{"paintseed":"875","item":"12341009736"},{"paintseed":"254","item":"9411385360"},{"paintseed":"254","item":"12636675977"},{"paintseed":"254","item":"12782240951"},{"paintseed":"129","item":"12721952361"},{"paintseed":"129","item":"7194716173"},{"paintseed":"129","item":"12288871573"},{"paintseed":"800","item":"12179095720"},{"paintseed":"432","item":"5846687077"},{"paintseed":"432","item":"11037266345"},{"paintseed":"432","item":"11821308730"},{"paintseed":"424","item":"11140198525"},{"paintseed":"424","item":"11140922896"},{"paintseed":"424","item":"5707550418"},{"paintseed":"424","item":"11255631342"},{"paintseed":"424","item":"6102155971"},{"paintseed":"424","item":"10055925379"},{"paintseed":"424","item":"10143865487"},{"paintseed":"424","item":"12617661850"},{"paintseed":"424","item":"12778090083"},{"paintseed":"146","item":"8355834643"},{"paintseed":"146","item":"3961210241"},{"paintseed":"146","item":"12482619179"},{"paintseed":"146","item":"4950299486"},{"paintseed":"9","item":"7242216928"},{"paintseed":"9","item":"12789675821"},{"paintseed":"9","item":"12259326420"},{"paintseed":"9","item":"12664611174"},{"paintseed":"9","item":"10020772131"},{"paintseed":"116","item":"12069684425"},{"paintseed":"116","item":"6907013130"},{"paintseed":"116","item":"11129007367"},{"paintseed":"202","item":"12836395904"},{"paintseed":"202","item":"10304485331"},{"paintseed":"202","item":"10798069905"},{"paintseed":"555","item":"6555450570"},{"paintseed":"555","item":"8106217931"},{"paintseed":"555","item":"7583368550"},{"paintseed":"555","item":"9167592063"},{"paintseed":"464","item":"8330305777"},{"paintseed":"464","item":"7334163646"},{"paintseed":"464","item":"12921927266"},{"paintseed":"464","item":"11521809280"},{"paintseed":"464","item":"11919756282"},{"paintseed":"283","item":"12884750091"},{"paintseed":"283","item":"11765643369"},{"paintseed":"283","item":"10924713924"},{"paintseed":"283","item":"12369331731"},{"paintseed":"283","item":"7723168747"},{"paintseed":"283","item":"4878696004"},{"paintseed":"381","item":"7872886889"},{"paintseed":"381","item":"8186256457"},{"paintseed":"381","item":"12795480617"},{"paintseed":"381","item":"9302780023"},{"paintseed":"381","item":"11179836665"},{"paintseed":"381","item":"12752769950"},{"paintseed":"381","item":"5210911055"},{"paintseed":"381","item":"11767156702"},{"paintseed":"381","item":"10373348692"},{"paintseed":"407","item":"12019006515"},{"paintseed":"407","item":"12394912691"},{"paintseed":"407","item":"11663040169"},{"paintseed":"407","item":"11445741028"},{"paintseed":"407","item":"12870632941"},{"paintseed":"407","item":"12898284932"},{"paintseed":"407","item":"3803709689"},{"paintseed":"407","item":"12754985610"},{"paintseed":"521","item":"4251249148"},{"paintseed":"521","item":"12162282048"},{"paintseed":"521","item":"12431591848"},{"paintseed":"521","item":"12854667159"},{"paintseed":"521","item":"12243684567"},{"paintseed":"521","item":"12476699552"},{"paintseed":"420","item":"12524866777"},{"paintseed":"420","item":"7120438780"},{"paintseed":"420","item":"10977755215"},{"paintseed":"420","item":"11080288334"},{"paintseed":"420","item":"12890979906"},{"paintseed":"420","item":"12826680163"},{"paintseed":"647","item":"8186476061"},{"paintseed":"647","item":"12196448585"},{"paintseed":"647","item":"9061453707"},{"paintseed":"647","item":"12707517282"},{"paintseed":"647","item":"2910156081"},{"paintseed":"647","item":"12387578707"},{"paintseed":"647","item":"11341009640"},{"paintseed":"647","item":"11960834316"},{"paintseed":"834","item":"9865066565"},{"paintseed":"834","item":"11418195800"},{"paintseed":"834","item":"6814301211"},{"paintseed":"616","item":"11008760864"},{"paintseed":"616","item":"12186062323"},{"paintseed":"616","item":"12315593280"},{"paintseed":"616","item":"11224969132"},{"paintseed":"616","item":"11682760501"},{"paintseed":"808","item":"11415524164"},{"paintseed":"808","item":"11523966226"},{"paintseed":"808","item":"5677629611"},{"paintseed":"808","item":"7989863660"},{"paintseed":"808","item":"12371414792"},{"paintseed":"808","item":"12553974189"},{"paintseed":"808","item":"12570472852"},{"paintseed":"808","item":"12814350018"},{"paintseed":"54","item":"10480284114"},{"paintseed":"54","item":"12813714538"},{"paintseed":"54","item":"12340136110"},{"paintseed":"54","item":"8833395643"},{"paintseed":"970","item":"12557712647"},{"paintseed":"970","item":"6172802013"},{"paintseed":"970","item":"12320565125"},{"paintseed":"970","item":"3538823311"},{"paintseed":"970","item":"12613969698"},{"paintseed":"970","item":"10433706340"},{"paintseed":"827","item":"10561726990"},{"paintseed":"827","item":"12800945425"},{"paintseed":"827","item":"5378744175"},{"paintseed":"827","item":"12783016203"},{"paintseed":"827","item":"6528966983"},{"paintseed":"975","item":"12732269562"},{"paintseed":"975","item":"11907582413"},{"paintseed":"975","item":"8492193871"},{"paintseed":"160","item":"12577441007"},{"paintseed":"160","item":"9139076347"},{"paintseed":"160","item":"12728223040"},{"paintseed":"160","item":"10784343502"},{"paintseed":"749","item":"8729717523"},{"paintseed":"749","item":"12468555412"},{"paintseed":"749","item":"5015381030"},{"paintseed":"749","item":"12578687794"},{"paintseed":"749","item":"12851276426"},{"paintseed":"749","item":"12292807609"},{"paintseed":"85","item":"12728636183"},{"paintseed":"7","item":"9736426451"},{"paintseed":"7","item":"9784424641"},{"paintseed":"7","item":"5132331654"},{"paintseed":"7","item":"7733435851"},{"paintseed":"7","item":"4014346750"},{"paintseed":"290","item":"10460014473"},{"paintseed":"290","item":"8251473410"},{"paintseed":"290","item":"7065144773"},{"paintseed":"949","item":"12695797045"},{"paintseed":"949","item":"10998372177"},{"paintseed":"949","item":"4461404551"},{"paintseed":"949","item":"12112664968"},{"paintseed":"814","item":"12594499019"},{"paintseed":"814","item":"12800291478"},{"paintseed":"814","item":"12831636840"},{"paintseed":"814","item":"12685317128"},{"paintseed":"814","item":"8024523413"},{"paintseed":"814","item":"5484257428"},{"paintseed":"530","item":"12875673399"},{"paintseed":"530","item":"12825964182"},{"paintseed":"530","item":"3013556612"},{"paintseed":"622","item":"10986475995"},{"paintseed":"622","item":"12918928274"},{"paintseed":"622","item":"12704029994"},{"paintseed":"622","item":"11757350224"},{"paintseed":"622","item":"11900979793"},{"paintseed":"622","item":"12582542225"},{"paintseed":"205","item":"10542591975"},{"paintseed":"205","item":"12871297624"},{"paintseed":"605","item":"12638179316"},{"paintseed":"605","item":"3371078687"},{"paintseed":"605","item":"48387582"},{"paintseed":"605","item":"3952134957"},{"paintseed":"605","item":"12050910801"},{"paintseed":"545","item":"5485049954"},{"paintseed":"545","item":"12665587731"},{"paintseed":"545","item":"12330649407"},{"paintseed":"545","item":"12864543184"},{"paintseed":"545","item":"219864297"},{"paintseed":"913","item":"12542258060"},{"paintseed":"913","item":"10834887439"},{"paintseed":"913","item":"9143191767"},{"paintseed":"913","item":"2944621729"},{"paintseed":"632","item":"2518484623"},{"paintseed":"632","item":"6701736845"},{"paintseed":"632","item":"9164676224"},{"paintseed":"632","item":"10515833748"},{"paintseed":"632","item":"12366832124"},{"paintseed":"632","item":"11635253426"},{"paintseed":"632","item":"12837014443"},{"paintseed":"639","item":"8278980101"},{"paintseed":"639","item":"12543391757"},{"paintseed":"639","item":"12617358753"},{"paintseed":"639","item":"10582575247"},{"paintseed":"639","item":"12589511849"},{"paintseed":"215","item":"4887343155"},{"paintseed":"215","item":"8169849803"},{"paintseed":"215","item":"10054827058"},{"paintseed":"215","item":"11502382216"},{"paintseed":"215","item":"2393993754"},{"paintseed":"37","item":"9802068158"},{"paintseed":"37","item":"12107540660"},{"paintseed":"37","item":"6560423108"},{"paintseed":"804","item":"11721300401"},{"paintseed":"804","item":"12800275883"},{"paintseed":"804","item":"10184677879"},{"paintseed":"804","item":"12824335309"},{"paintseed":"174","item":"9616170399"},{"paintseed":"174","item":"12895865243"},{"paintseed":"174","item":"9763379128"},{"paintseed":"174","item":"11971795674"},{"paintseed":"174","item":"12685463009"},{"paintseed":"174","item":"9666408539"},{"paintseed":"174","item":"4987447644"},{"paintseed":"690","item":"10192468381"},{"paintseed":"690","item":"11428730455"},{"paintseed":"689","item":"12328181918"},{"paintseed":"278","item":"7491324532"},{"paintseed":"278","item":"12432498667"},{"paintseed":"278","item":"8767776868"},{"paintseed":"278","item":"9250591150"},{"paintseed":"487","item":"7162889729"},{"paintseed":"487","item":"4529625578"},{"paintseed":"487","item":"12915404579"},{"paintseed":"487","item":"10294134740"},{"paintseed":"487","item":"12550111594"},{"paintseed":"487","item":"2553856324"},{"paintseed":"487","item":"10602103211"},{"paintseed":"674","item":"10107290404"},{"paintseed":"674","item":"8236087308"},{"paintseed":"826","item":"7342251197"},{"paintseed":"826","item":"3693570086"},{"paintseed":"826","item":"3877207573"},{"paintseed":"826","item":"9894032691"},{"paintseed":"214","item":"12852334028"},{"paintseed":"214","item":"10652376723"},{"paintseed":"214","item":"12806976252"},{"paintseed":"214","item":"12809644524"},{"paintseed":"214","item":"11033616746"},{"paintseed":"214","item":"11728175219"},{"paintseed":"214","item":"10662904609"},{"paintseed":"214","item":"5975169097"},{"paintseed":"214","item":"7867755664"},{"paintseed":"570","item":"11715228030"},{"paintseed":"570","item":"10923872242"},{"paintseed":"570","item":"3207301211"},{"paintseed":"570","item":"3266696620"},{"paintseed":"570","item":"6237095506"},{"paintseed":"570","item":"8012048338"},{"paintseed":"570","item":"3300104168"},{"paintseed":"570","item":"4702096755"},{"paintseed":"570","item":"12046163446"},{"paintseed":"60","item":"7787776720"},{"paintseed":"60","item":"7054621018"},{"paintseed":"68","item":"9854231583"},{"paintseed":"68","item":"12239512689"},{"paintseed":"68","item":"12928895624"},{"paintseed":"68","item":"12663179299"},{"paintseed":"68","item":"3691763279"},{"paintseed":"68","item":"6760128592"},{"paintseed":"68","item":"7689581828"},{"paintseed":"810","item":"8938386996"},{"paintseed":"810","item":"11930766613"},{"paintseed":"810","item":"10175051311"},{"paintseed":"485","item":"12750720836"},{"paintseed":"485","item":"12455741183"},{"paintseed":"485","item":"4765682350"},{"paintseed":"485","item":"12827234996"},{"paintseed":"822","item":"8413481007"},{"paintseed":"822","item":"11770472219"},{"paintseed":"822","item":"8950323360"},{"paintseed":"822","item":"9007646817"},{"paintseed":"822","item":"12379762540"},{"paintseed":"787","item":"12004404707"},{"paintseed":"787","item":"3349314384"},{"paintseed":"787","item":"12733322102"},{"paintseed":"662","item":"12403036482"},{"paintseed":"662","item":"8395705743"},{"paintseed":"567","item":"6703176271"},{"paintseed":"567","item":"679662830"},{"paintseed":"567","item":"5227898818"},{"paintseed":"567","item":"12646863006"},{"paintseed":"302","item":"12880706657"},{"paintseed":"458","item":"10244881418"},{"paintseed":"458","item":"12816196418"},{"paintseed":"458","item":"4948762602"},{"paintseed":"458","item":"4742403679"},{"paintseed":"458","item":"12608508365"},{"paintseed":"458","item":"6427366050"},{"paintseed":"243","item":"6796146722"},{"paintseed":"243","item":"12843695543"},{"paintseed":"243","item":"8872323174"},{"paintseed":"243","item":"8896913951"},{"paintseed":"243","item":"10916517620"},{"paintseed":"243","item":"9946397654"},{"paintseed":"532","item":"6800027993"},{"paintseed":"532","item":"10256477353"},{"paintseed":"532","item":"9935314107"},{"paintseed":"532","item":"5553931191"},{"paintseed":"383","item":"12782861456"},{"paintseed":"383","item":"12811138892"}]');
        foreach ($patterns as $pattern){
                Paintseed::create(['item_id' => $pattern->item, 'value' => $pattern->paintseed]);
        }

        return 'OK';
    }

    public function getSteam()
    {
        $tasks = Task::with('item')->where('pattern', '!=', null)->where('client', '=', 'ska4an')
            ->where('site_id', '=', '7')->get();

        $paintseeds = [];
        foreach ($tasks as $task){
            $paterns = $task->item->patterns->where('name', '=', $task->pattern)->toArray();
            foreach ($paterns as $patern){
                $paintseeds[] = $patern['value'];

            }
        }
        $steam_ids = DB::table('paintseeds')->whereIn('value',$paintseeds)->distinct()->pluck('item_id')->toArray();

        return json_encode($steam_ids);

    }
}
